{
  "sql": "-- Enable RLS\nALTER DATABASE postgres SET \"app.jwt_secret\" TO 'your-jwt-secret';\n\n-- Create tables\nCREATE TABLE IF NOT EXISTS \"public\".\"Bitcoiner\" (\n    \"handle\" TEXT PRIMARY KEY,\n    \"created_at\" TIMESTAMPTZ DEFAULT NOW(),\n    \"pubkey\" TEXT NOT NULL,\n    \"avatar\" TEXT\n);\n\nCREATE TABLE IF NOT EXISTS \"public\".\"Post\" (\n    \"txid\" TEXT PRIMARY KEY,\n    \"amount\" BIGINT NOT NULL,\n    \"handle_id\" TEXT NOT NULL,\n    \"content\" TEXT DEFAULT '',\n    \"created_at\" TIMESTAMPTZ DEFAULT NOW(),\n    \"locked_until\" BIGINT DEFAULT 0,\n    \"media_url\" TEXT,\n    CONSTRAINT \"Post_handle_id_fkey\" FOREIGN KEY (\"handle_id\") REFERENCES \"public\".\"Bitcoiner\"(\"handle\") ON DELETE CASCADE\n);\n\nCREATE TABLE IF NOT EXISTS \"public\".\"LockLike\" (\n    \"txid\" TEXT PRIMARY KEY,\n    \"amount\" BIGINT NOT NULL,\n    \"handle_id\" TEXT NOT NULL,\n    \"locked_until\" BIGINT DEFAULT 0,\n    \"created_at\" TIMESTAMPTZ DEFAULT NOW(),\n    \"post_id\" TEXT NOT NULL,\n    CONSTRAINT \"LockLike_handle_id_fkey\" FOREIGN KEY (\"handle_id\") REFERENCES \"public\".\"Bitcoiner\"(\"handle\") ON DELETE CASCADE,\n    CONSTRAINT \"LockLike_post_id_fkey\" FOREIGN KEY (\"post_id\") REFERENCES \"public\".\"Post\"(\"txid\") ON DELETE CASCADE\n);\n\n-- Create indexes for better query performance\nCREATE INDEX IF NOT EXISTS \"post_handle_id_idx\" ON \"public\".\"Post\"(\"handle_id\");\nCREATE INDEX IF NOT EXISTS \"locklike_handle_id_idx\" ON \"public\".\"LockLike\"(\"handle_id\");\nCREATE INDEX IF NOT EXISTS \"locklike_post_id_idx\" ON \"public\".\"LockLike\"(\"post_id\");\nCREATE INDEX IF NOT EXISTS \"post_created_at_idx\" ON \"public\".\"Post\"(\"created_at\");\nCREATE INDEX IF NOT EXISTS \"locklike_created_at_idx\" ON \"public\".\"LockLike\"(\"created_at\");\n\n-- Enable Row Level Security\nALTER TABLE \"public\".\"Bitcoiner\" ENABLE ROW LEVEL SECURITY;\nALTER TABLE \"public\".\"Post\" ENABLE ROW LEVEL SECURITY;\nALTER TABLE \"public\".\"LockLike\" ENABLE ROW LEVEL SECURITY;\n\n-- Create policies\nCREATE POLICY \"Enable read access for all users\" ON \"public\".\"Bitcoiner\"\n    FOR SELECT\n    USING (true);\n\nCREATE POLICY \"Enable read access for all users\" ON \"public\".\"Post\"\n    FOR SELECT\n    USING (true);\n\nCREATE POLICY \"Enable read access for all users\" ON \"public\".\"LockLike\"\n    FOR SELECT\n    USING (true);\n\n-- Insert default anon user if it doesn't exist\nINSERT INTO \"public\".\"Bitcoiner\" (\"handle\", \"pubkey\")\nVALUES ('anon', '02eb0b9d11e2d4989ba95e6c787fc25b3e7ce14b79dc5902036000429671ef5362')\nON CONFLICT (\"handle\") DO NOTHING;"
} 